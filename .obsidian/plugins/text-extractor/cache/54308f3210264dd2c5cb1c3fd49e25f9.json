{"path":"Lecture Kmutt/INT209/2023-INT209-05-Reverse Proxy.pdf","text":"INT 2 0 9 D ev O p s Ol a r n R o j a n a po r n pu n Th u rs d ay , 9 May 2 0 2 4 LA B - 05 R e ve r s e P r o x y IN T 2 0 9 De v Op s R ev er s e P r o x y ❍ A r e v e r s e p r o x y i s a s e r v e r t h at ( t r an s p ar e n t l y ) f o r w ar d s th e cl i e n t's r e q u e sts to o n e o r m o r e w e b se r v e r s ❍ A r e v e r s e p r o x y s i t s i n f r o n t o f an o r i g i n s e r v e r an d e n s u r e s t h at n o c l i e n t e v e r c o m m u n i c at e s d i r e c t l y w i t h t h at o r i g i n se r v e r ❍ R e v e r s e p r o x i e s h e l p i n c r e as e s c al ab i l i t y , p e r f o r m an c e , r e s i l i e n c e , an d s e c u r i t y 2 ht t p s : / / en . w i ki p ed i a . o r g /w i k i / R e v e r s e _p r o x y ht t p s : / / www. c l o u d f l ar e . c o m / en - gb /l e a r n i n g / cd n /g l o s s a r y /r e ve r s e - pr o x y / IN T 2 0 9 De v Op s R ev er s e P r o x y 3 ht t p s : / / www. c l o u d f l ar e . c o m / en - gb /l e a r n i n g / cd n /g l o s s a r y /r e ve r s e - pr o x y / IN T 2 0 9 De v Op s S I T W eb R ev er s e w it h n es t ed p a t h 4 B r o w s er in t p r o j 2 3 . s it . k m u t t . a c . t h /f t / tas k ip 2 3 f t Re v e r s e Pr o x y 202. 44. 9. 103 ip 2 3 f t .s i t .k m u t t .ac .t h / t as k in t p r o j 2 3 . s it . k m u t t . a c : 8 0 8 0 /f t / v1/t a s k s ip 2 3 f t .s i t .k m u t t .ac :8 0 8 0 /v1/t a s k s KM U T T N e t w o r k fo r w a r d po r t 8 0 , 4 4 3 , 8 0 8 0 dev s er v er B r o w s er ip 2 3 f t .s i t .k m u t t .ac .t h /f t / tas k ip 2 3 f t .s i t .k m u t t .ac .t h :8 0 8 0 /f t / v1/t a s k s No t e t h a t d ev s er v er w i l l g et r eq ues t s wi t h U R L i n t p r o j2 3 . s i t . k m u t t . a c . t h / t a s k IN T 2 0 9 De v Op s W it h o u t R ev er s e P r o x y 5 f ip 2 3 f t ip 2 3 f t .s i t .k m u t t .ac .t h / t as k ip 2 3 f t .s i t .k m u t t .ac :8 0 8 0 /v1/t a s k s KM U T T N e t w o r k :8 0 8 0 :8 0 Ba c k - en d Fr o nt - en d IN T 2 0 9 De v Op s R ev er s e P r o x y : P r iv a t e U R L 6 f ip 2 3 f t Re v e r s e Pr o x y ip 2 3 f t . s it . k m u t t . a c . t h /t a s k ip 2 3 f t . s it . k m u t t . a c /a p i / /v1/t a s k s KM U T T N e t w o r k :8 0 8 0 :8 0 Ba c k - en d Fr o nt - en d ba c ke n d : 8 0 8 0 /v1/t a s k s fr o n t en d /t a s k IN T 2 0 9 De v Op s P r iv a t e U R L w it h N es t ed P a t h 7 f ip 2 3 f t Re v e r s e Pr o x y ip 2 3 f t . s it . k m u t t . a c . t h /t a s k ip 2 3 f t . s it . k m u t t . a c /a p i / /v1/t a s k s KM U T T N e t w o r k :8 0 8 0 :8 0 Ba c k - en d Fr o nt - en d ba c ke n d : 8 0 8 0 /v1/t a s k s fr o n t en d /t a s k ip 2 3 f t . s it . k m u t t . a c /f t /a p i / /v1/t a s k s ip 2 3 f t . s it . k m u t t . a c . t h /f t / tas k IN T 2 0 9 De v Op s D a t e P r o j ec t 8 f lv m 65999 Re v e r s e Pr o x y lv m 6 5 9 9 9 . s it . k m u t t . a c . t h /d a t e p r o j/ lv m 6 5 9 9 9 . s it . k m u t t . a c /d a t e p r o j/ ap i / d ate KM U T T N e t w o r k :8 0 8 0 :8 0 Ba c k - en d Fr o nt - en d ba c ke n d : 8 0 8 0 /a p i / da t e fr o n t en d / IN T 2 0 9 De v Op s S a m p le N g in x C o n f ig F ile 9 server { listen 80 default_server; server_name lvm65999.sit.kmutt.ac.th; location /dateproj/ { proxy_pass http://dateproj-fe/; } location /dateproj/api/ { proxy_pass http://dateproj-api:8080/api/; # uses 808 0/api/ since endpoint path is /api/date } } dateproj.conf IN T 2 0 9 De v Op s E x er c is e ❍ D e p l o y f e t c h d at e an d d at e ap i w i t h r e v e r s e p r o x y u n d e r / d at e p r o j / n e s t e d p at h o n p o r t 8 0 10 IN T 2 0 9 De v Op s S o lu t io n 11 cd dateproj-api ./mvnw clean package docker run --name dateproj-api -d --network dateproj-net -v ./target:/app openjdk:17-jdk- alpine sh -c \"java -jar /app/*.jar\" dateproj - api # create network for dateproj docker network create dateproj-net mkdir 209lab5; cd 209lab5 git clone https://github.com/olarnr/int210-dateproj.git dateproj cd dateproj cd ../dateproj-fe npm install # change API_URL to `/dateproj/api/date` nano src/App.vue # change \"build\": \"vite build --base=/dateproj/\", nano package.json npm run build docker run --name dateproj-fe -d --network dateproj-net -v ./default.conf:/etc/nginx/conf.d/default.conf -v ./dist/:/dist/ nginx:alpine dateproj - fe IN T 2 0 9 De v Op s S o lu t io n 12 cd ../dateproj-proxy # use config file shown in sli de #9 nana dateproj.conf docker run --name dateproj-proxy -d -p 80:80 --network dateproj-net -v ./dateproj.conf:/etc/nginx/conf.d/dateproj.conf nginx:alpine dateproj - proxy server { listen 80; server_name _; root /dist; index index.html; location / { try_files $uri $uri/ =404; } } dateproj - fe/default.conf IN T 2 0 9 De v Op s I n t eg r a t ed P r o j ec t G u id elin e 1. R u n ‘ p r o x y ’ c o n t ai n e r t h at p u b l i s h p o r t 8 0 as i n t e r m e d i at e r e v e r s e p r o x y s e r v e r 2. C r e at e 2 n g i n x c o n f i g f i l e s , o n e f o r ‘ i p 2 3 x x x ’ an d an o t h e r fo r ‘ i n t p ro j 2 3 ’ 3. T h e ‘ i p 2 3 x x x . c o n f ’ s h o u l d f o r w ar d r e q u e s t s w i t h ‘ / x x x / ’ b as e p at h 4. C o n f i g i n . e n v . p r o d u c t i o n t h e A P I _U R L t o ‘ / x x x / ap i / v 1 ’ 13","libVersion":"0.3.1","langs":""}